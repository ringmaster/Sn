import{a as b,t as x}from"../chunks/disclose-version.B3pU-Qvx.js";import{h as A,Y as U,Z as V,_ as W,$ as Z,p as C,f as H,t as L,a as Q,y as v,c as i,r as d,b as _,D as c,a0 as $}from"../chunks/runtime.B1HgvF_b.js";import{e as q,s as S}from"../chunks/render.C_lAy8j2.js";import{o as X,i as D}from"../chunks/index-client.BrZWagJM.js";import{s as ee,i as te,a as ae}from"../chunks/store.CWEYL-O0.js";import{w as re}from"../chunks/index.COQLb8xY.js";let N=!1;function Y(){N||(N=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function O(e){if(A){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var o=e.value;T(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var a=e.checked;T(e,"checked",null),e.checked=a}}};e.__on_r=r,U(r),Y()}}function T(e,t,r,o){var a=e.__attributes??(e.__attributes={});A&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="loading"&&(e[V]=r),e.removeAttribute(t))}function oe(e,t,r,o=r){e.addEventListener(t,r);const a=e.__on_r;a?e.__on_r=()=>{a(),o()}:e.__on_r=o,Y()}function j(e,t,r=t){var o=W();oe(e,"input",()=>{var a=B(e)?M(e.value):e.value;r(a),o&&a!==(a=t())&&(e.value=a??"")}),Z(()=>{var a=t();if(A&&e.defaultValue!==e.value){r(e.value);return}B(e)&&a===M(e.value)||e.type==="date"&&!a&&!e.value||(e.value=a??"")})}function B(e){var t=e.type;return t==="number"||t==="range"}function M(e){return e===""?null:+e}const h=re({loggedIn:!1,username:null,title:"Sn"});async function I(){try{const e=await fetch("./api");if(!e.ok)throw h.set({loggedIn:!1,username:null,title:"Sn"}),new Error("Failed to fetch data");const t=await e.json();h.set(t)}catch(e){h.set({loggedIn:!1,username:null,title:"Sn"}),console.error("Error fetching data:",e)}}var se=x('<div class="mb-4"><div class="container mx-auto px-4 text-center"><h2 class="text-xl font-bold mb-4 text-center"> </h2></div> <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Logout</button></div>'),ne=x('<p class="mt-4 text-center text-red-500"> </p>'),le=x('<form class="w-full max-w-sm mx-auto mt-8"><div class="mb-4"><label class="block text-gray-700 text-sm font-bold mb-2" for="username">Username</label> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" required autocomplete="username"></div> <div class="mb-6"><label class="block text-gray-700 text-sm font-bold mb-2" for="password">Password</label> <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" required autocomplete="current-password"></div> <div class="flex items-center justify-between"><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">Login</button></div> <!></form>'),ie=x('<div class="container mx-auto px-4"><h1 class="text-2xl font-bold mb-4 text-center"> </h1></div> <!>',1);function me(e,t){C(t,!1);const r=ee(),o=()=>ae(h,"$dataStore",r);let a=$(""),w=$(""),u=$("");X(()=>{I()});async function z(f){f.preventDefault();const s=btoa(`${v(a)}:${v(w)}`),n=await fetch("./api",{method:"POST",headers:{Authorization:`Basic ${s}`}});if(n.ok)try{let l=JSON.parse(await n.text());l.loggedIn?c(u,`Logged in as ${l.username}`):c(u,"Login failed. Please check your credentials.")}catch{c(u,"Login request failed.")}else c(u,"Login failed. Please check your credentials.");I()}async function F(){(await fetch("./api",{method:"DELETE"})).ok?c(u,"Logged out successfully."):c(u,"Logout request failed."),I()}te();var E=ie(),y=H(E),P=i(y),G=i(P);d(P),d(y);var J=_(y,2);D(J,()=>o().loggedIn,f=>{var s=se(),n=i(s),l=i(n),m=i(l);d(l),d(n);var p=_(n,2);d(s),L(()=>S(m,`Welcome, ${o().username??""}!`)),q("click",p,F),b(f,s)},f=>{var s=le(),n=i(s),l=_(i(n),2);O(l),d(n);var m=_(n,2),p=_(i(m),2);O(p),d(m);var K=_(m,4);D(K,()=>v(u),g=>{var k=ne(),R=i(k);d(k),L(()=>S(R,v(u))),b(g,k)}),d(s),j(l,()=>v(a),g=>c(a,g)),j(p,()=>v(w),g=>c(w,g)),q("submit",s,z),b(f,s)}),L(()=>S(G,o().title)),b(e,E),Q()}export{me as component};
